# 리트코드 : 1141. User Activity for the Past 30 Days I
* https://leetcode.com/problems/user-activity-for-the-past-30-days-i/description/
<br>

---

## 문제
```text
Table: Activity

+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| user_id       | int     |
| session_id    | int     |
| activity_date | date    |
| activity_type | enum    |
+---------------+---------+
This table may have duplicate rows.
The activity_type column is an ENUM (category) of type ('open_session', 'end_session', 'scroll_down', 'send_message').
The table shows the user activities for a social media website. 
Note that each session belongs to exactly one user.
 

Write a solution to find the daily active user count for a period of 30 days ending 2019-07-27 inclusively. A user was active on someday if they made at least one activity on that day.

Return the result table in any order.

The result format is in the following example.

 

Example 1:

Input: 
Activity table:
+---------+------------+---------------+---------------+
| user_id | session_id | activity_date | activity_type |
+---------+------------+---------------+---------------+
| 1       | 1          | 2019-07-20    | open_session  |
| 1       | 1          | 2019-07-20    | scroll_down   |
| 1       | 1          | 2019-07-20    | end_session   |
| 2       | 4          | 2019-07-20    | open_session  |
| 2       | 4          | 2019-07-21    | send_message  |
| 2       | 4          | 2019-07-21    | end_session   |
| 3       | 2          | 2019-07-21    | open_session  |
| 3       | 2          | 2019-07-21    | send_message  |
| 3       | 2          | 2019-07-21    | end_session   |
| 4       | 3          | 2019-06-25    | open_session  |
| 4       | 3          | 2019-06-25    | end_session   |
+---------+------------+---------------+---------------+
Output: 
+------------+--------------+ 
| day        | active_users |
+------------+--------------+ 
| 2019-07-20 | 2            |
| 2019-07-21 | 2            |
+------------+--------------+ 
Explanation: Note that we do not care about days with zero active users.
```

<br>

## 문제 풀이

### **MySQL**
```SQL
SELECT ACTIVITY_DATE AS DAY, COUNT(DISTINCT USER_ID) AS ACTIVE_USERS
FROM ACTIVITY
WHERE ACTIVITY_DATE BETWEEN DATE_SUB('2019-07-27', INTERVAL 29 DAY) AND '2019-07-27'
GROUP BY ACTIVITY_DATE
```

* 마지막 날짜 2019 07 27을 기준으로 30일을 포함해야 한다.
* 29일을 빼주면 마지막 날짜 포함 30일의 WINDOW가 생긴다.
* GROUP BY로 카운팅하기
  
### **Pandas**
```python
import pandas as pd

def user_activity(activity: pd.DataFrame) -> pd.DataFrame:

    end = pd.to_datetime('2019-07-27')
    start = end-timedelta(days=29)
    temp = activity[activity['activity_date'].between(start,end)]
    answer = temp.groupby('activity_date').agg(active_users=('user_id','nunique')).reset_index()
    answer.rename(columns={'activity_date':'day'}, inplace=True)
    return answer
```

* 같은 방식으로 날짜 29일을 빼주고 between 적용
* agg 집계함수에 n unique를 써준다.
* count + distinct느낌
  
<br>

### **코멘트**
* 날짜는 실제 데이터에서 자주 나와서 기억해야함
